import{useCallback as e,useEffect as t,useMemo as n,useLayoutEffect as r,useState as o,useRef as c}from"react";import{raf as u}from"@studio-freight/tempus";import{throttle as s}from"throttle-debounce";function i(n,r){const o=e(e=>{n.current&&!n.current.contains(e.target)&&r()},[n,r]);t(()=>{if(n.current)return document.addEventListener("mousedown",o),()=>{document.removeEventListener("mousedown",o)}},[o,n])}const a=()=>n(()=>"undefined"!=typeof window&&(window.location.href.includes("#debug")||"development"===process.env.NODE_ENV),[]),d="undefined"!=typeof window,f=d?r:t,l="undefined"!=typeof window?function(){const[e,n]=o(()=>"undefined"!=typeof document?document.readyState:"loading");return f(()=>{if("undefined"!=typeof document)return n(document.readyState),document.addEventListener("readystatechange",e,!1),()=>document.removeEventListener("readystatechange",e,!1);function e(){n(document.readyState)}},[]),t(()=>{"undefined"!=typeof document&&"complete"===document.readyState&&n("complete")},[]),e}:()=>{};let v=[];const p=e=>{let{type:t}=e;"string"==typeof e&&(t=e);const n=[];n.push("string"==typeof e?{type:t}:e),v.forEach(([e,r])=>{"string"==typeof e&&e!==t||("function"!=typeof e||e(...n))&&r(...n)})},m=(e,n,r=[])=>(t(()=>((e,t)=>{if(null==e)throw new Error("Invalid filter");if(null==t)throw new Error("Invalid callback");return v=[...v,[e,t]],()=>{v=v.filter(e=>e[1]!==t)}})(e,n),[...r,n,e]),p);function h(e,t=0){f(()=>{if(e){const n=u.add(e,t);return()=>{u.remove(n)}}},[e,t])}const w=(e,n)=>{const r=c(),o=c();return t(()=>{r.current=e}),t(()=>{if(null!==n)return o.current=setInterval(function(){r.current()},n),()=>clearInterval(o.current)},[n]),()=>clearInterval(o.current)};var y=d?()=>{const n=e(()=>{try{return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}catch(e){return!1}},[]),[r,c]=o(n()),u=e(()=>{c(n())},[n]);return t(()=>(u(),window.addEventListener("resize",u,{passive:!0}),()=>{window.removeEventListener("resize",u,{passive:!0})}),[u]),r}:()=>{};const g=({root:n=null,rootMargin:r="0px",threshold:u=1,once:s=!1}={})=>{const i=c(),a=c(),[d,f]=o(!1),l=e(e=>{a.current||(a.current=e)},[]),v=e(e=>{const[t]=e;f(t.isIntersecting)},[]);return t(()=>(i.current=new IntersectionObserver(v,{root:n,rootMargin:r,threshold:u}),a.current&&i.current.observe(a.current),()=>{i.current&&i.current.disconnect()}),[v]),t(()=>{s&&d&&i.current.disconnect()},[d]),{setRef:l,inView:d}},E=r=>{const c=n(()=>{if(d)try{return window.matchMedia(r)}catch(e){"production"!==process.env.NODE_ENV&&console.error(e)}return null},[r]),[u,s]=o(!!c&&c.matches),i=e(({matches:e})=>{s(e)},[]);return t(()=>{if(c)return i(c),c.addEventListener("change",i,{passive:!0}),()=>{c.removeEventListener("change",i,{passive:!0})}},[c,i]),u};function b(){return b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},b.apply(this,arguments)}function O(e,t=0){const n=t+e.offsetTop;return e.offsetParent?O(e.offsetParent,n):n}function L(e,t=0){const n=t+e.offsetLeft;return e.offsetParent?L(e.offsetParent,n):n}function I({lazy:n=!1,debounce:r=1e3}={}){const u=c(),i=c(),[a,d]=o({}),f=c(a),l=e(()=>{if(u.current){const e=O(u.current),t=L(u.current);f.current=b({},f.current,{top:e,left:t}),n||d(f.current)}},[n]);t(()=>{const e=s(r,l),t=new ResizeObserver(e);return t.observe(document.body),()=>{t.disconnect(),e.cancel({upcomingOnly:!0})}},[r,l]);const v=e(([e])=>{const{width:t,height:r}=e.contentRect;f.current=b({},f.current,{width:t,height:r}),n||d(f.current)},[n]),p=e(()=>f.current,[]);return t(()=>()=>{var e;"development"!==process.env.NODE_ENV&&(null==(e=i.current)||e.disconnect())},[]),[e(e=>{var t;e&&e!==u.current&&(null==(t=i.current)||t.disconnect(),i.current=new ResizeObserver(v),i.current.observe(e),u.current=e)},[l]),n?p:a]}const P=(e=[],t=[])=>{const r=n(()=>t&&[t].flat(),[t]),o=n(()=>e&&[e].flat(),[e]);return n(()=>{if(!r||!o)return;const t=o.map(e=>{var t;return null==(t=r.find(t=>t.type===e))?void 0:t.props.children});return e[0]?t:t[0]},[r,o])};export{p as dispatch,a as useDebug,l as useDocumentReadyState,m as useEventBus,h as useFrame,w as useInterval,y as useIsTouchDevice,g as useIsVisible,f as useLayoutEffect,E as useMediaQuery,i as useOutsideClickEvent,I as useRect,P as useSlots};
//# sourceMappingURL=index.modern.mjs.map
