import{useCallback as e,useEffect as t,useMemo as r,useLayoutEffect as n,useState as o,useRef as c}from"react";import{raf as s}from"@studio-freight/tempus";import{throttle as u}from"throttle-debounce";function i(r,n){const o=e(e=>{r.current&&!r.current.contains(e.target)&&n()},[r,n]);t(()=>{if(r.current)return document.addEventListener("mousedown",o),()=>{document.removeEventListener("mousedown",o)}},[o,r])}var a=()=>r(()=>"undefined"!=typeof window&&(window.location.href.includes("#debug")||"development"===process.env.NODE_ENV),[]);const d="undefined"!=typeof window,f=d?n:t;var l=f,v=d?function(){const[e,t]=o(document.readyState);return f(()=>{function e(){t(document.readyState)}return t(document.readyState),document.addEventListener("readystatechange",e,!1),()=>document.removeEventListener("readystatechange",e,!1)},[]),e}:()=>{};let p=[];const h=e=>{let{type:t}=e;"string"==typeof e&&(t=e);const r=[];r.push("string"==typeof e?{type:t}:e),p.forEach(([e,n])=>{"string"==typeof e&&e!==t||("function"!=typeof e||e(...r))&&n(...r)})};var m=(e,r,n=[])=>(t(()=>((e,t)=>{if(null==e)throw new Error("Invalid filter");if(null==t)throw new Error("Invalid callback");return p=[...p,[e,t]],()=>{p=p.filter(e=>e[1]!==t)}})(e,r),[...n,r,e]),h);function w(e,t=0){f(()=>{if(e){const r=s.add(e,t);return()=>{s.remove(r)}}},[e,t])}var y=(e,r)=>{const n=c(),o=c();return t(()=>{n.current=e}),t(()=>{if(null!==r)return o.current=setInterval(function(){n.current()},r),()=>clearInterval(o.current)},[r]),()=>clearInterval(o.current)},g=d?()=>{const r=e(()=>{try{return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}catch(e){return!1}},[]),[n,c]=o(r()),s=e(()=>{c(r())},[r]);return t(()=>(s(),window.addEventListener("resize",s,{passive:!0}),()=>{window.removeEventListener("resize",s,{passive:!0})}),[s]),n}:()=>{},E=({root:r=null,rootMargin:n="0px",threshold:s=1,once:u=!1}={})=>{const i=c(),a=c(),[d,f]=o(!1),l=e(e=>{a.current||(a.current=e)},[]),v=e(e=>{const[t]=e;f(t.isIntersecting)},[]);return t(()=>(i.current=new IntersectionObserver(v,{root:r,rootMargin:n,threshold:s}),a.current&&i.current.observe(a.current),()=>{i.current&&i.current.disconnect()}),[v]),t(()=>{u&&d&&i.current.disconnect()},[d]),{setRef:l,inView:d}},b=n=>{const c=r(()=>{if(d)try{return window.matchMedia(n)}catch(e){"production"!==process.env.NODE_ENV&&console.error(e)}return null},[n]),[s,u]=o(!!c&&c.matches),i=e(({matches:e})=>{u(e)},[]);return t(()=>{if(c)return i(c),c.addEventListener("change",i,{passive:!0}),()=>{c.removeEventListener("change",i,{passive:!0})}},[c,i]),s};function L(){return L=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},L.apply(this,arguments)}function O(e,t=0){const r=t+e.offsetTop;return e.offsetParent?O(e.offsetParent,r):r}function I(e,t=0){const r=t+e.offsetLeft;return e.offsetParent?I(e.offsetParent,r):r}function P({lazy:r=!1,debounce:n=1e3}={}){const s=c(),i=c(),[a,d]=o({}),f=c(a),l=e(()=>{if(s.current){const e=O(s.current),t=I(s.current);f.current=L({},f.current,{top:e,left:t}),r||d(f.current)}},[r]);t(()=>{const e=u(n,l),t=new ResizeObserver(e);return t.observe(document.body),()=>{t.disconnect(),e.cancel({upcomingOnly:!0})}},[n,l]);const v=e(([e])=>{const{width:t,height:n}=e.contentRect;f.current=L({},f.current,{width:t,height:n}),r||d(f.current)},[r]),p=e(()=>f.current,[]);return t(()=>()=>{var e;"development"!==process.env.NODE_ENV&&(null==(e=i.current)||e.disconnect())},[]),[e(e=>{var t;e&&e!==s.current&&(null==(t=i.current)||t.disconnect(),i.current=new ResizeObserver(v),i.current.observe(e),s.current=e)},[l]),r?p:a]}var D=(e=[],t=[])=>{const n=r(()=>t&&[t].flat(),[t]),o=r(()=>e&&[e].flat(),[e]);return r(()=>{if(!n||!o)return;const t=o.map(e=>{var t;return null==(t=n.find(t=>t.type===e))?void 0:t.props.children});return e[0]?t:t[0]},[n,o])};export{h as dispatch,a as useDebug,v as useDocumentReadyState,m as useEventBus,w as useFrame,y as useInterval,g as useIsTouchDevice,E as useIsVisible,l as useLayoutEffect,b as useMediaQuery,i as useOutsideClickEvent,P as useRect,D as useSlots};
//# sourceMappingURL=index.modern.mjs.map
