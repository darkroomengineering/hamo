import{useCallback as e,useEffect as n,useMemo as t,useLayoutEffect as r,useState as o,useRef as c}from"react";import{raf as u}from"@studio-freight/tempus";import{throttle as i}from"throttle-debounce";function s(t,r){const o=e(e=>{t.current&&!t.current.contains(e.target)&&r()},[t,r]);n(()=>{if(t.current)return document.addEventListener("mousedown",o),()=>{document.removeEventListener("mousedown",o)}},[o,t])}const a="undefined"!=typeof window,f=a?function(){return t(()=>(window.location.href.includes("#debug")||"development"===process.env.NODE_ENV)&&!window.location.href.includes("#production"),[])}:()=>{},d=a?r:n,l=a?function(){const[e,n]=o(document.readyState);return d(()=>{function e(){n(document.readyState)}return n(document.readyState),document.addEventListener("readystatechange",e,!1),()=>document.removeEventListener("readystatechange",e,!1)},[]),e}:()=>{};let v=[];function p(e){let{type:n}=e;"string"==typeof e&&(n=e);const t=[];t.push("string"==typeof e?{type:n}:e),v.forEach(([e,r])=>{"string"==typeof e&&e!==n||("function"!=typeof e||e(...t))&&r(...t)})}function h(e,t,r=[]){return n(()=>function(e,n){if(null==e)throw new Error("Invalid filter");if(null==n)throw new Error("Invalid callback");return v=[...v,[e,n]],()=>{v=v.filter(e=>e[1]!==n)}}(e,t),[...r,t,e]),p}function m(e,n=0){d(()=>{if(e){const t=u.add(e,n);return()=>{u.remove(t)}}},[e,n])}function w(e,t){const r=c(),o=c();return n(()=>{r.current=e}),n(()=>{if(null!==t)return o.current=setInterval(function(){r.current()},t),()=>clearInterval(o.current)},[t]),()=>clearInterval(o.current)}const y=a?function(){const t=e(()=>{try{return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}catch(e){return!1}},[]),[r,c]=o(t()),u=e(()=>{c(t())},[t]);return n(()=>(u(),window.addEventListener("resize",u,{passive:!0}),()=>{window.removeEventListener("resize",u,{passive:!0})}),[u]),r}:()=>{};function g({root:t=null,rootMargin:r="0px",threshold:u=1,once:i=!1}={}){const s=c(),a=c(),[f,d]=o(!1),l=e(e=>{a.current||(a.current=e)},[]),v=e(e=>{const[n]=e;d(n.isIntersecting)},[]);return n(()=>(s.current=new IntersectionObserver(v,{root:t,rootMargin:r,threshold:u}),a.current&&s.current.observe(a.current),()=>{s.current&&s.current.disconnect()}),[v]),n(()=>{i&&f&&s.current.disconnect()},[f]),{setRef:l,inView:f}}function E(r){const c=t(()=>{if(a)try{return window.matchMedia(r)}catch(e){"production"!==process.env.NODE_ENV&&console.error(e)}return null},[r]),[u,i]=o(!!c&&c.matches),s=e(({matches:e})=>{i(e)},[]);return n(()=>{if(c)return s(c),c.addEventListener("change",s,{passive:!0}),()=>{c.removeEventListener("change",s,{passive:!0})}},[c,s]),u}function b(){return b=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},b.apply(this,arguments)}function O(e,n=0){const t=n+e.offsetTop;return e.offsetParent?O(e.offsetParent,t):t}function L(e,n=0){const t=n+e.offsetLeft;return e.offsetParent?L(e.offsetParent,t):t}function I({lazy:t=!1,debounce:r=1e3}={}){const u=c(),s=c(),[a,f]=o({}),d=c(a),l=e(()=>{if(u.current){const e=O(u.current),n=L(u.current);d.current=b({},d.current,{top:e,left:n}),t||f(d.current)}},[t]);n(()=>{const e=i(r,l),n=new ResizeObserver(e);return n.observe(document.body),()=>{n.disconnect(),e.cancel({upcomingOnly:!0})}},[r,l]);const v=e(([e])=>{const{width:n,height:r}=e.contentRect;d.current=b({},d.current,{width:n,height:r}),t||f(d.current)},[t]),p=e(()=>d.current,[]);return n(()=>()=>{var e;"development"!==process.env.NODE_ENV&&(null==(e=s.current)||e.disconnect())},[]),[e(e=>{var n;e&&e!==u.current&&(null==(n=s.current)||n.disconnect(),s.current=new ResizeObserver(v),s.current.observe(e),u.current=e)},[l]),t?p:a]}function P(e=[],n=[]){const r=t(()=>n&&[n].flat(),[n]),o=t(()=>e&&[e].flat(),[e]);return t(()=>{if(!r||!o)return;const n=o.map(e=>{var n;return null==(n=r.find(n=>n.type===e))?void 0:n.props.children});return e[0]?n:n[0]},[r,o])}export{p as dispatch,f as useDebug,l as useDocumentReadyState,h as useEventBus,m as useFrame,w as useInterval,y as useIsTouchDevice,g as useIsVisible,d as useLayoutEffect,E as useMediaQuery,s as useOutsideClickEvent,I as useRect,P as useSlots};
//# sourceMappingURL=index.modern.mjs.map
