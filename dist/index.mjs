import{useCallback as n,useEffect as t,useMemo as e,useLayoutEffect as r,useState as o,useRef as u}from"react";import{raf as c}from"@studio-freight/tempus";import{throttle as i}from"throttle-debounce";function f(e,r){var o=n(function(n){e.current&&!e.current.contains(n.target)&&r()},[e,r]);t(function(){if(e.current)return document.addEventListener("mousedown",o),function(){document.removeEventListener("mousedown",o)}},[o,e])}var a="undefined"!=typeof window,d=a?function(){return e(function(){return(window.location.href.includes("#debug")||"development"===process.env.NODE_ENV)&&!window.location.href.includes("#production")},[])}:function(){},s=a?r:t,v=a?function(){var n=o(function(){return"undefined"!=typeof document?document.readyState:"loading"}),e=n[0],r=n[1];return s(function(){if("undefined"!=typeof document)return r(document.readyState),document.addEventListener("readystatechange",n,!1),function(){return document.removeEventListener("readystatechange",n,!1)};function n(){r(document.readyState)}},[]),t(function(){"undefined"!=typeof document&&"complete"===document.readyState&&r("complete")},[]),e}:function(){},l=[];function p(n){var t=n.type;"string"==typeof n&&(t=n);var e=[];e.push("string"==typeof n?{type:t}:n),l.forEach(function(n){var r=n[0],o=n[1];"string"==typeof r&&r!==t||("function"!=typeof r||r.apply(void 0,e))&&o.apply(void 0,e)})}function m(n,e,r){return void 0===r&&(r=[]),t(function(){return function(n,t){if(null==n)throw new Error("Invalid filter");if(null==t)throw new Error("Invalid callback");return l=[].concat(l,[[n,t]]),function(){l=l.filter(function(n){return n[1]!==t})}}(n,e)},[].concat(r,[e,n])),p}function h(n,t){void 0===t&&(t=0),s(function(){if(n){var e=c.add(n,t);return setId(e),function(){c.remove(e)}}},[n,t]),useEffect(function(){return function(){id&&c.remove(id)}},[id])}function y(n,e){var r=u(),o=u();return t(function(){r.current=n}),t(function(){if(null!==e)return o.current=setInterval(function(){r.current()},e),function(){return clearInterval(o.current)}},[e]),function(){return clearInterval(o.current)}}var w=a?function(){var e=n(function(){try{return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}catch(n){return!1}},[]),r=o(e()),u=r[0],c=r[1],i=n(function(){c(e())},[e]);return t(function(){return i(),window.addEventListener("resize",i,{passive:!0}),function(){window.removeEventListener("resize",i,{passive:!0})}},[i]),u}:function(){};function g(e){var r=void 0===e?{}:e,c=r.root,i=void 0===c?null:c,f=r.rootMargin,a=void 0===f?"0px":f,d=r.threshold,s=void 0===d?1:d,v=r.once,l=void 0!==v&&v,p=u(),m=u(),h=o(!1),y=h[0],w=h[1],g=n(function(n){m.current||(m.current=n)},[]),E=n(function(n){w(n[0].isIntersecting)},[]);return t(function(){return p.current=new IntersectionObserver(E,{root:i,rootMargin:a,threshold:s}),m.current&&p.current.observe(m.current),function(){p.current&&p.current.disconnect()}},[E]),t(function(){l&&y&&p.current.disconnect()},[y]),{setRef:g,inView:y}}function E(r){var u=e(function(){if(a)try{return window.matchMedia(r)}catch(n){"production"!==process.env.NODE_ENV&&console.error(n)}return null},[r]),c=o(!!u&&u.matches),i=c[0],f=c[1],d=n(function(n){f(n.matches)},[]);return t(function(){if(u)return d(u),u.addEventListener("change",d,{passive:!0}),function(){u.removeEventListener("change",d,{passive:!0})}},[u,d]),i}function b(){return b=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},b.apply(this,arguments)}function O(n,t){void 0===t&&(t=0);var e=t+n.offsetTop;return n.offsetParent?O(n.offsetParent,e):e}function L(n,t){void 0===t&&(t=0);var e=t+n.offsetLeft;return n.offsetParent?L(n.offsetParent,e):e}function I(e){var r=void 0===e?{}:e,c=r.lazy,f=void 0!==c&&c,a=r.debounce,d=void 0===a?1e3:a,s=u(),v=u(),l=o({}),p=l[0],m=l[1],h=u(p),y=n(function(){if(s.current){var n=O(s.current),t=L(s.current);h.current=b({},h.current,{top:n,left:t}),f||m(h.current)}},[f]);t(function(){var n=i(d,y),t=new ResizeObserver(n);return t.observe(document.body),function(){t.disconnect(),n.cancel({upcomingOnly:!0})}},[d,y]);var w=n(function(n){var t=n[0].contentRect;h.current=b({},h.current,{width:t.width,height:t.height}),f||m(h.current)},[f]),g=n(function(){return h.current},[]);return t(function(){return function(){var n;"development"!==process.env.NODE_ENV&&(null==(n=v.current)||n.disconnect())}},[]),[n(function(n){var t;n&&n!==s.current&&(null==(t=v.current)||t.disconnect(),v.current=new ResizeObserver(w),v.current.observe(n),s.current=n)},[y]),f?g:p]}function P(n,t){void 0===n&&(n=[]),void 0===t&&(t=[]);var r=e(function(){return t&&[t].flat()},[t]),o=e(function(){return n&&[n].flat()},[n]);return e(function(){if(r&&o){var t=o.map(function(n){var t;return null==(t=r.find(function(t){return t.type===n}))?void 0:t.props.children});return n[0]?t:t[0]}},[r,o])}export{p as dispatch,d as useDebug,v as useDocumentReadyState,m as useEventBus,h as useFrame,y as useInterval,w as useIsTouchDevice,g as useIsVisible,s as useLayoutEffect,E as useMediaQuery,f as useOutsideClickEvent,I as useRect,P as useSlots};
//# sourceMappingURL=index.mjs.map
